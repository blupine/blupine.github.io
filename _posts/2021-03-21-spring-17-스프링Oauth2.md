---
layout: post
title:  "[스프링] OAuth2.0 - 카카오 로그인"
subtitle: ""
date:   2021-03-22 22:11:21 +0900
categories: dev
tags : Spring
---

### OAuth2.0
- Open API로 제공되는 표준 인증 방법
- 쉽게 말해서 (Naver, Kakao, Google, Facebook)에 가입된 사용자 정보로 내가 만든 서비스에 인증(로그인)을 하는 것
-

#### OAuth2.0의 4가지 주요 객체(역할)
- `Resource Owner`
    - 로그인을 요청하는 사용자, 즉 인증 정보의 주인
- `Client`
    - `Resource Owner`의 자원에 대한 접근을 `Authorization Server`에 요청하는 서비스(내가 만든 백엔드 서버)
- `Authorization Server`
    - `Resource Owner`의 요청으로 사용자를 인증하고, 인증 토큰, access token을 발급해주는 인증 서버
- `Resource Server`
    - `Resource Owner`의 자원을 가지고 있는 서버, access token을 발급받은 `Client`가 요청하면, 권한을 검증해서 자원을 반환


#### 인증 절차
- ![1]({{"assets/img/dev/spring/17/1.png" | absolute_url}})
- 1. 사용자가 '카카오 로그인' 버튼을 눌러 인증 시도(redirect_url을 함께 전달해서 인증이 완료되면 `Client` 서버로 redirect)
    - ```
        GET /oauth/authorize?client_id={REST_API_KEY}&redirect_uri={REDIRECT_URI}&response_type=code HTTP/1.1
        Host: kauth.kakao.com
        ```
- 2. 서버`Authorization Server`는 사용자를 인증하고 `인가 코드`를 발급(1번에서 전달받은 redirect_url로 인가 코드를 전달)
- 3. `인가 코드`를 전달받은 `Client`는 `Authorization Server`에 `인가 코드`를 전달하면서 `access token` 발급을 요청함
    - ```
        POST /oauth/token HTTP/1.1
        Host: kauth.kakao.com
        Content-type: application/x-www-form-urlencoded;charset=utf-8
        ```
- 4. `access token`을 이용해서 `Resource Server`에 사용자 정보를 요청함
    - [kakao developers]({{"https://developers.kakao.com/docs/latest/ko/kakaologin/rest-api#req-user-info"}})
    - ```
        GET/POST /v2/user/me HTTP/1.1
        Host: kapi.kakao.com
        Authorization: Bearer {ACCESS_TOKEN}
        Content-type: application/x-www-form-urlencoded;charset=utf-8
        ```
